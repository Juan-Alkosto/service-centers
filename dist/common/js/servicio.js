/*! service-centers - v1.0.9 */
"use strict";import Map from"./map.js";import Select from"./select.js";import ServiceCenter from"./service-center.js";((e,n,t)=>{const a={get:async(e="")=>{if(e.length)return await fetch(e,{cache:"force-cache",mode:"cors"}).then(e=>e.json()).then(e=>e)},map:{init:async()=>{w=new Map({$element:"#service-centers-map",baseSite:e.site}),t.addEventListener("click",e=>{e.target.classList.contains("service-centers__map__info-window__close")&&w.infoWindow.close()}),n.onresize=(()=>{n.innerWidth>d&&"0"!=t.getElementById("departamento").value?t.querySelector(".service-centers__map").style.display="block":t.querySelector(".service-centers__map").style.display="none"})}},menu:{render:({active:e,address:n,areaCode:t,cellphone:a,id:r,map:s,name:i,phone:c})=>{let o="",l="";for(const e of c)o+=`<a href="tel:+57${t}${e.replace(/\s/g,"")}" title="Llamar a ${i}">${e}</a>`;for(const e of a)l+=`<a href="tel:+57${e.replace(/\s/g,"")}" title="Llamar a ${i}">${e}</a>`;return`<div class="service-centers__menu__item">\n                    <input type="radio" name="centro-servicio" id="${r}" ${e?"checked":""}>\n                    <label for="${r}">${i}<span class="${e?"alk-icon-arrow-up":"alk-icon-arrow-down"}"></span></label>\n                    <div class="service-centers__menu__item__body" data-service-center="${r}">\n                        <div class="address">\n                            <p><strong><i class="alk-icon-rounded-position"></i> Dirección:</strong>\n                                ${n}</p>\n                        </div>\n                        <div class="contact-phones">\n                            ${c.length?`<div class="phone">\n                                <p><strong><i class="alk-icon-customer-contact"></i> Contacto telefónico:</strong>\n                                    ${o}\n                                </p>\n                            </div>`:""}\n                            ${a.length?`<div class="cell">\n                                <p><strong><i class="alk-icon-phone-contact"></i> Celular:</strong>\n                                    ${l}\n                                </p>\n                            </div>`:""}\n                        </div>\n                        <div class="how-to-get">\n                            <p>\n                                <i class="alk-icon-arrive"></i><a rel="noopener" href="${s}" title="Indicaciones para llegar a ${i}" target="_blank">¿Cómo llegar?</a>\n                            </p>\n                        </div>\n                    </div>\n                </div>`},toogleArrow:()=>{const e=t.querySelectorAll(".service-centers__menu__item > input");e.forEach(n=>{n.addEventListener("change",n=>{e.forEach(e=>{const t=e.nextElementSibling.querySelector("span");n.target===e?t.classList.replace("alk-icon-arrow-down","alk-icon-arrow-up"):t.classList.replace("alk-icon-arrow-up","alk-icon-arrow-down")})})})},animateMarker:()=>{t.querySelectorAll(".service-centers__menu__item__body").forEach(e=>{e.addEventListener("mouseenter",()=>{w.bounceMarker(e.dataset.serviceCenter,"start")}),e.addEventListener("mouseleave",()=>{w.bounceMarker(e.dataset.serviceCenter,"stop")})})}},select:{init:()=>t.querySelectorAll("[data-custom-select").forEach(e=>new Select(e))}},r=t.getElementById("marca"),s=t.getElementById("departamento"),i=t.getElementById("ciudad"),c=t.getElementById("categoria"),o=new Option("Selecciona una opción",0,!0,!0),l=t.querySelector(".service-centers__menu"),d=Number(getComputedStyle(t.documentElement).getPropertyValue("--service-centers-breakpoint").replace("px",""));let p=o,u=o,m=o,v=o,h=!0,w=null,g=new Array,f=new Array,y=new Array;async function _({servicePointsCodes:e,serviceCenters:n}){let t="";const a=[];return e.map(({code:e,areaCode:n})=>{a.push(e),t=n}),e=[...new Set(a)],await e.map(e=>{let a={id:e,areaCode:t,coordinates:{lat:n[e].lat,lng:n[e].lng}};return a={...a,...n[e]},new ServiceCenter(a)})}function b(e){l.innerHTML="",w.setMarkers(e),e.map(e=>(e.active=h,h=!1,l.insertAdjacentHTML("beforeend",a.menu.render(e)))),a.menu.toogleArrow(),a.menu.animateMarker()}t.addEventListener("updateCenter",e=>{const n=e.detail.center;if(null!==n){const e=t.getElementById(n);e.click(),setTimeout(()=>t.querySelector(".service-centers__menu").scrollTop=e.offsetTop,250)}}),null!==r&&(p=new Option(`Selecciona una ${r.labels[0].textContent.toLowerCase()}`,0,!0,!0),r.append(p)),null!==s&&(u=new Option(`Selecciona un ${s.labels[0].textContent.toLowerCase()}`,0,!0,!0),s.append(u),null!==r&&(s.disabled=!0)),null!==i&&(m=new Option(`Selecciona una ${i.labels[0].textContent.toLowerCase()}`,0,!0,!0),i.append(m),i.disabled=!0),null!==c&&(v=new Option(`Selecciona una ${c.labels[0].textContent.toLowerCase()}`,0,!0,!0),c.append(v),c.disabled=!0),a.select.init(),void 0!==e.jsonFile&&a.get(e.jsonFile).then(async({brands:e,categories:o,departments:l,serviceCenters:p})=>{await a.map.init(),void 0!==e&&null!==r&&(Object.entries(e).map(async e=>{const n=e[1],t=e[0],a=new Option(n.name,t);return r.append(a)}),r.refresh(),r.addEventListener("change",async()=>{h=!0,s.innerHTML="",s.append(u),w.infoWindow.close(),e[r.value].departments.map(e=>{const n=new Option(l[e].name,e);return s.append(n)}),s.disabled=!1,s.refresh(),i.innerHTML="",i.disabled=!0,i.append(m),i.refresh(),c.innerHTML="",c.disabled=!0,c.append(v),c.refresh(),y=[]})),void 0!==l&&null!==s&&(Object.entries(l).map(e=>{const n=e[1],t=e[0],a=new Option(n.name,t);return s.append(a)}),s.refresh(),s.addEventListener("change",async()=>{g=[],f=[],h=!0,i.innerHTML="",i.append(m),w.infoWindow.close(),n.innerWidth>d&&(t.querySelector(".service-centers__map").style.display="block"),t.querySelector(".msje-localiza").innerText="Localiza los centros de servicio técnico:",Object.entries(l[s.value].cities).map(e=>{const n=e[0];return Object.entries(e[1].categories).map(t=>t[1].stores.map(a=>{const s={code:a,areaCode:e[1].areaCode};return null===r?y.push(s):a.match(r.value)?(g.push(n),f.push(t[0]),y.push(s)):void 0}))}),await _({servicePointsCodes:y,serviceCenters:p}).then(e=>b(e)),g=[...new Set(g)],f=[...new Set(f)],Object.entries(l[s.value].cities).map(e=>{if(!g.length){const n=e[1],t=e[0],a=new Option(n.name,t);return i.append(a)}g.map(n=>{if(e[0]===n){const t=e[1],a=new Option(t.name,n);return i.append(a)}})}),i.disabled=!1,i.refresh(),c.innerHTML="",c.disabled=!0,c.append(v),c.refresh(),y=[]})),null!==i&&i.addEventListener("change",async()=>{h=!0,c.innerHTML="",c.append(v),Object.values(l[s.value].cities[i.value].categories).map(({stores:e})=>e.map(e=>{const n={code:e,areaCode:l[s.value].cities[i.value].areaCode};return null===r?y.push(n):e.match(r.value)?y.push(n):void 0})),await _({servicePointsCodes:y,serviceCenters:p}).then(e=>b(e)),Object.entries(l[s.value].cities[i.value].categories).map(e=>{if(!f.length){const n=o[e[0]].name,t=e[0],a=new Option(n,t);return c.append(a)}f.map(n=>{if(e[0]===n){const e=o[n].name,t=new Option(e,n);return c.append(t)}})}),c.disabled=!1,c.refresh(),y=[]}),void 0!==o&&null!==c&&c.addEventListener("change",async()=>{h=!0,Object.values(l[s.value].cities[i.value].categories[c.value].stores).map(e=>{const n={code:e,areaCode:l[s.value].cities[i.value].areaCode};return y.push(n)}),await _({servicePointsCodes:y,serviceCenters:p}).then(e=>b(e)),y=[]})})})(appConfig,window,document);